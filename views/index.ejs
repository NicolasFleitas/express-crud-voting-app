<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Learn It, Love It</title>
    <link rel="stylesheet" href="/css/styles.css">

</head>

<body>
    <h1>üöÄ Learn It, Love It</h1>

    <section>
        <h2>Nuevo Tema de Aprendizaje</h2>
        <form action="/temas" method="POST">
            <input type="text" name="title" placeholder="Ej: Aprender Node.js" required>
            <button type="submit">Agregar Tema</button>
        </form>
    </section>

    <hr>

    <section>
        <h2>Temas Populares</h2>

        <% if (topics.length===0) { %>
            <p>No hay temas todav√≠a. ¬°S√© el primero en agregar uno!</p>
            <% } else { %>
                <% topics.forEach(topic=> { %>
                    <div class="topic-card">
                        <div style="display:flex; justify-content:space-between;">
                            <div style="display:flex; justify-content:space-between; align-items:center;">
                                <h3>
                                    <%= topic.title %>
                                        <small>(Votos: <span id="votes-topic-<%= topic.id %>">
                                                <%= topic.votes %>
                                            </span>)</small>
                                </h3>

                                <div style="display:flex; gap: 10px;">
                                    <button class="btn-vote" data-type="topic" data-id="<%= topic.id %>">üëç
                                        Votar</button>

                                    <form action="/temas/delete/<%= topic.id %>" method="POST"
                                        onsubmit="return confirm('¬øBorrar tema?');">
                                        <button type="submit" class="btn-delete">X</button>
                                    </form>
                                </div>
                            </div>
                        </div>

                        <ul class="link-list">
                            <% topic.links.forEach(link=> { %>
                                <li>
                                    <button class="btn-vote" data-type="link" data-id="<%= link.id %>">üëç</button>

                                    <a href="<%= link.url %>" target="_blank">
                                        <%= link.title %>
                                    </a>

                                    <small>(Votos: <span id="votes-link-<%= link.id %>">
                                            <%= link.votes %>
                                        </span>)</small>

                                    <form action="/enlaces/delete/<%= link.id %>" method="POST" style="display:inline;">
                                        <button type="submit"
                                            style="font-size:0.7em; color:red; border:none; background:none; cursor:pointer;">[borrar]</button>
                                    </form>
                                </li>
                                <% }) %>
                        </ul>

                        <div style="margin-top: 10px; padding-top: 10px; border-top: 1px dashed #ccc;">
                            <small>Agregar recurso:</small>
                            <form action="/temas/<%= topic.id %>/enlaces" method="POST">
                                <input type="text" name="title" placeholder="T√≠tulo (ej: Documentaci√≥n)" required>
                                <input type="url" name="url" placeholder="https://..." required>
                                <button type="submit">A√±adir</button>
                            </form>
                        </div>

                    </div>
                    <% }) %>
                        <% } %>
    </section>
    <script src="/js/main.js"></script>
</body>

</html>